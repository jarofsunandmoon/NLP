<h1 id="zyOZo">论文标题：Long-Term EEG Partitioning for Seizure Onset Detection（<font style="color:rgba(0, 0, 0, 0.85);">用于癫痫发作检测的长期脑电信号分割</font>）</h1>
**主要内容：**

****

****

<h2 id="eockq">研究背景</h2>
<font style="color:rgba(0, 0, 0, 0.85);">深度学习模型在使用脑电(EEG)数据自动检测癫痫发作方面取得了令人印象深刻的成功。他们将脑电记录划分为一系列二级纪元，旨在准确地对它们进行分类。</font><font style="color:rgba(0, 0, 0, 0.85);">虽然已经证明了最先进的(SOTA)性能，但不能提供癫痫检测研究的内在信息，即癫痫发作的起始时间(SO)。这种基于分类的方法虽然不用捕获EEG的上下文信息和长序列上的依赖关系，但是容易出现无法解释的错误，进而导致误判。</font>

<font style="color:rgba(0, 0, 0, 0.85);">另外</font><font style="color:rgba(0, 0, 0, 0.85);">一些研究提出了两阶段法。它们使用后处理来平滑突变并降低误检率。基于多数投票，滑动窗口内的样本被重新分配一致的标签。然而，有几个限制仍然没有解决：第一，缺乏明确的SO检测建模；第二，特征利用率不足；第三，缺乏长序列依赖关系建模。</font>

<h2 id="bNGZN">论文提出的研究方法</h2>
<h3 id="F5wOH">SODor框架</h3>
<font style="color:rgba(0, 0, 0, 0.85);">SODor是一个两阶段框架，旨在明确检测癫痫发作，由分类模型(F(·))和后序聚类模型(H(·))组成。F(·)通过有监督学习来学习正常状态和癫痫状态下通道逻辑的二级相关表示。H(·)然后将第二级历元序列聚集成子序列。子序列中的历元是连续的，并且每个子序列都依赖于它的邻居。子序列/簇分配之间的转换可被视为癫痫发作。</font>

![](https://raw.githubusercontent.com/jarofsunandmoon/ImageStore/main/25.11.17-25.11.18%E5%91%A8%E6%8A%A5%E5%9B%BE%E7%89%87/1763350776559-846d1488-0d3d-4cac-af22-c0fe7a30726f.png)

<h3 id="ZWEMV">框架实现</h3>
**第一部分：第二级分类模型**

+ **输入**：将EEG信号经过滑动窗口分为P个时间片段，	将每个时间片段归一化处理表示为$ X_P
 $.
+ **特征处理**：
    - Second-Level Representation Learning（第二级表征学习）：基于EEG信号X = [X1, . . . ,XP]构建图G = (V, E)。节点V代表不同的通道，节点之间的边E代表各通道之间的相关性。
    - Channel Correlation for Graph Construction（用于构建图的通道相关性）
+ **特征编码**：
    - Channel Logits Representation Learning（通道对数表征学习）
    - 嵌入，池化

**第二部分：序列级聚类和分割**

+ **输入**：从第二级表示学习阶段得到的输出是每个时间片段的标签（如正常或癫痫的概率），这些标签作为输入传递给聚类模型。
+ **Subsequence Clustering（子序列聚类）**：SODor框架通过子序列聚类方法将一系列时间片段进行聚类。每个聚类表示一个持续的状态（如正常状态或癫痫状态）。在这个阶段，模型将会识别出一组“子序列”，即一段连续的EEG片段，其中的状态保持一致（都是正常或都是癫痫）。
+ **Temporal Consistency（时间一致性）**：为了保持EEG片段之间的时间一致性，聚类模型会鼓励相邻的片段被分配到同一簇。这样可以避免突然的状态变化，帮助捕捉EEG信号中的长时间依赖性和发作的起始点。
+ **Seizure Onset Detection（SO检测）**：在聚类的基础上，SODor框架通过“簇转移点”来标定癫痫发作的起始时间（Seizure Onset）。当模型检测到从正常状态到癫痫状态的转变时，即认为该时间点为发作起始时间。簇的转换表示了发作的发生。

**1、框架贡献**

**（1）子序列聚类公式化的癫痫发作起始时间（SO）检测**：

传统的基于分类的方法虽然能够检测EEG信号是否存在癫痫发作，但它们无法明确检测到癫痫发作的起始时间（Seizure Onset, SO）。SODor的创新之处在于它将SO检测问题公式化为**子序列聚类问题**。通过这种方法，SODor能够自动识别和分割出表征一致状态（正常或癫痫）的子序列，这些子序列中的状态转移点就代表了癫痫发作的起始时间（SO）。子序列聚类的思路是通过聚类方法将连续的EEG片段分配到不同的簇中，每个簇代表一个一致的状态（例如，正常状态或癫痫状态）。簇之间的转移就标志着癫痫发作的开始。

**（2）通道对数表示（Channel Logits Representation）**：

SODor提出了一种新的特征表示方法——**通道对数表示**（channel logits）。这意味着它不仅使用分类模型来判断每个片段的标签，还通过学习EEG通道之间的相关性来获得更深层次的理解。通过学习这些通道间的相关性，SODor能够揭示EEG信号中多个通道的交互关系，以及这些关系与癫痫发作的关联。这种方法通过生成通道的对数值（logits），使得分类模型能够更加清晰地理解每个EEG片段中癫痫发作的概率。

**（3）时间一致性建模**：

SODor在其框架中引入了**时间一致性建模**，这意味着它能够考虑EEG序列中各个片段之间的时间依赖关系。传统的分类方法通常是独立地处理每个时间片段，而SODor通过聚类约束来确保相邻的EEG片段在同一簇中，促进了子序列内的时间一致性。换句话说，SODor鼓励相邻的EEG时间片段被分配到同一簇，从而避免了急剧误分类的问题，并且能够更准确地捕捉癫痫发作的演变过程。

<h3 id="l1iX8">创新点</h3>
+ **显式SO检测**：与传统的分类方法不同，SODor框架不仅检测癫痫是否存在，还显式地建模了癫痫发作的起始时间（SO）。通过聚类方法，SODor能够在EEG信号中识别发作的开始，避免了分类方法中的突然误分类。
+ **通道相关性和时序依赖性建模**：通过学习EEG信号中各个通道之间的相关性，SODor能更好地捕捉跨通道的动态变化，同时通过时间一致性建模来考虑信号中的长期依赖关系，这使得检测更为准确和鲁棒。

<h3 id="uZzN1">实验</h3>
<h4 id="Rnm49">数据集</h4>
<font style="color:rgba(0, 0, 0, 0.85);">作者在三个真实世界的数据集上评估了Sodor的癫痫发作(SO)检测任务。此外，他们还评估了一项更具挑战性的任务：癫痫发作预测，旨在识别癫痫发作前的发作前状态。这项任务在临床环境中是至关重要的，作者们提供了它的发病信息，称为PSO(发作前发作)。CHB-MIT包括22名患者844小时的连续头皮脑电数据，记录在22个通道上，总共有163次癫痫发作。对于PSO检测任务，我们通过将癫痫发作前5分钟的状态定义为癫痫发作前5分钟来对该数据集进行预处理。HUH收集自芬兰赫尔辛基大学。它由79名患者的头皮21道脑电数据组成，服务于癫痫检测任务。TUSZ数据集是天普大学医院EEG癫痫语料库的一部分。它包括5,612个脑电记录和3,050个临床注释的癫痫发作。我们使用了19个脑电通道，遵循标准的10-20系统。我们将每个数据集分为70%/20%/10%用于训练、测试和验证。我们将所有纪元的ID存储在患者记录中，从而能够在长期记录中调用以验证检测准确性。</font>

<h4 id="AmYF0">Baselines</h4>
![](https://raw.githubusercontent.com/jarofsunandmoon/ImageStore/main/25.11.17-25.11.18%E5%91%A8%E6%8A%A5%E5%9B%BE%E7%89%87/1763369727458-9f4079d8-3a7e-460e-8072-a8fb287c900a.png)

<font style="color:rgba(0, 0, 0, 0.85);">1.(Burrello等人，2020)提出了一种后处理方法，它使用滑动的5秒窗口来根据患者特定的投票阈值重新分配标签。</font>

<font style="color:rgba(0, 0, 0, 0.85);">2.(Boo 等人，2021)提出了一种两步法，首先用深层模型对二级历元进行分类，然后用加权阶段对SO概率进行评分。</font>

<font style="color:rgba(0, 0, 0, 0.85);">3.(Li等人，2021b)提出了一种基于四种机器学习模型的集成学习后处理方法，并使用多数投票来确定SO阈值。</font>

<font style="color:rgba(0, 0, 0, 0.85);">4.(Tang等人，2022)提出了一种基于GNN的癫痫发作检测和分类方法。</font>

<font style="color:rgba(0, 0, 0, 0.85);">5.(Ho and Armanfard，2023)提出了一种包含对比学习的GNN模型用于癫痫分类。</font>

<font style="color:rgba(0, 0, 0, 0.85);">6.Time2State(Wang等人，2023)是一种为多变量时间序列量身定做的深度聚类方法。</font>

<font style="color:rgba(0, 0, 0, 0.85);">7.E2Usd(Lai等人，2024)将特征嵌入的每个维度表示为多变量时间序列，并对其进行子序列聚类。</font>

<h4 id="RjOZ5"><font style="color:rgba(0, 0, 0, 0.85);">Experiment: Overall SO Detection</font></h4>
![](https://raw.githubusercontent.com/jarofsunandmoon/ImageStore/main/25.11.17-25.11.18%E5%91%A8%E6%8A%A5%E5%9B%BE%E7%89%87/1763371315625-e822b432-1356-4413-98f2-8e04a851c60d.png)

**（1）实验设计**

与基线方法的比较：

+ SODor与三种后处理（PP）方法、两种基于分类（Cls）的方法以及两种深度聚类（Clu）方法进行了对比。
+ 后处理方法（例如，Burrello等人（2020）、Boo等人（2021）和Li等人（2021）的方法）通常在分类之后应用，目的是通过平滑标签来减少误检测。
+ 基于分类的方法（如Siyi等人（2022）、Thi等人（2023）的方法）是通过单一的分类模型进行SO检测。
+ 深度聚类方法（如Time2State（2023）和E2Usd（2024））使用聚类模型来进行SO检测。

**（2）实验结果**

**基线方法的表现**：

后处理方法（如Burrello等人（2020））在CHB-MIT数据集上表现较好，但明显不如SODor，尽管它们能够通过平滑标签来减少误检，但需要依赖于手动调整参数；基于分类的方法（如Siyi等人（2022））在不同数据集上也表现不错，但在复杂的多变信号（如TUH数据集）中，表现相对较差；深度聚类方法（如Time2State和E2Usd）表现逊色，特别是在没有考虑时间一致性的情况下，无法准确检测SO。

**SODor的表现**：

**CHB-MIT数据集**：SODor显著优于所有基线方法，达到了**0.979的NMI**，**0.964的ARI**和**0.981的ACC**，远超其他方法。**HUH数据集**：SODor也表现出了良好的性能，得到了**0.873的NMI**，**0.823的ARI**和**0.845的ACC**，同样高于基线方法。**TUSZ数据集**：SODor在该数据集上同样超越了其他方法，获得了**0.842的NMI**，**0.863的ARI**和**0.879的ACC**。

由上图可视化可明显看出 SODor不仅在检测精度上表现出色，而且具有**更强的鲁棒性**，能够有效减少误分类和假阳性。  

<h4 id="cc3U3">Experiment: Representation Analysis</h4>
 该实验的主要目的是评估不同池化方法对通道对数表示（logits representation）的影响，以及这些池化方法在不同训练设置下的表现。  

![](https://raw.githubusercontent.com/jarofsunandmoon/ImageStore/main/25.11.17-25.11.18%E5%91%A8%E6%8A%A5%E5%9B%BE%E7%89%87/1763371429821-740b22a8-a4d9-4fd1-ae52-0a66db3c9a12.png)

**（1）实验设计**

 为了保持分析的一致性，作者进一步可视化了图3(a)中使用的TUH案例，重点关注了训练后来自不同通道的对数值（logits）。如在“提出的方法”部分所讨论的，池化操作在SODor框架中起着关键作用，特别是在总结和提取来自通道的重要特征方面。为了评估它们的影响，作者将提出的最大池化方法替换为加权池化（使用多层感知机（MLP））和均值池化，同时保持相同的参数设置。有趣的是，最终的分类准确率保持不变，为0.816。

**（2）实验结果**

**  如上图4所示：**

| **方法** | **最大池化（ Max Pooling  ）** | **均值池化（ Mean Pooling  ）** | **加权池化（ Weight Pooling  ）** |
| --- | --- | --- | --- |
| **效果** |  实验结果表明，最大池化方法在特征表示上表现最为稳定，并且在不同的训练设置下保持较好的性能。与其他池化方法相比，最大池化能够更好地捕捉EEG信号中的关键特征，尤其是在癫痫发作检测时。   |  均值池化虽然在一些情况下表现良好，但它倾向于平滑掉信号中的一些重要异常，导致在癫痫发作的敏感特征上有所损失。因此，均值池化在检测癫痫发作的精度上稍逊色于最大池化。   |  加权池化在不同训练设置下表现不稳定，有时会导致特征表示的失真。加权池化在处理不同强度的信号时可能会过度强调某些频率分量，影响模型的鲁棒性和准确性。   |


<h4 id="tOMe2">Experiment: Channel Correlation Visualization</h4>
![](https://raw.githubusercontent.com/jarofsunandmoon/ImageStore/main/25.11.17-25.11.18%E5%91%A8%E6%8A%A5%E5%9B%BE%E7%89%87/1763372066858-8d5f8d54-38d6-4a5d-bdeb-ea0291ec0cf2.png)

**（1）实验设置**

<font style="color:rgba(0, 0, 0, 0.85);">作者按照(Tang等人)中概述的方法将通道映射回EEG电极和图形节点位置。2022)，以可视化正常和癫痫集群模型中的通道相关性。对于包含19个以上EEG通道的CHB-MIT，使用标准的19通道系统进行可视化，与TUH的设置一致。可视化中的每个连接对应于一个在Θ中持久存在的“1”。</font>

**（2）实验结果**

**正常状态与癫痫状态的通道相关性对比**：

+ **正常状态**下，通道之间的连接较为稀疏。尤其是脑电信号的某些区域（如枕叶区域，O1和O2通道）保持稳定的连接，表明在正常情况下，大脑的某些区域是功能性稳定的。
+ **癫痫状态**下，通道之间的相关性变得更加密集，尤其是涉及癫痫发作区域的通道之间的连接显著增强。这些变化表明癫痫发作会导致大脑不同区域的电活动更加同步和强烈。

**从通道相关性中识别癫痫发作区域**：

+ 在癫痫发作期间，某些通道（例如与发作源区域相关的通道）表现出较强的相关性，而其他区域则保持相对不变。这表明，SODor能够通过学习到的通道相关性来定位癫痫发作的源区域，并提供对癫痫发作发生的早期信号的洞察。

<h4 id="bmva7">Clustering Method Ablation（聚类方法消融实验）</h4>
![](https://raw.githubusercontent.com/jarofsunandmoon/ImageStore/main/25.11.17-25.11.18%E5%91%A8%E6%8A%A5%E5%9B%BE%E7%89%87/1763371951073-93e5c1af-2172-43f8-a769-6be2e9646365.png)

<font style="color:rgba(0, 0, 0, 0.85);">表2表明，作者的方法可以显著优于MDL和DPGMM，以最低的标准偏差获得最高的值。原因可能是基于MDL的方法侧重于模型压缩损失，而没有明确考虑时间一致性。DPGMM更侧重于估计集群的数量。我们的方法还可以使用贝叶斯信息准则(BIC)来估计聚类的数量。由于癫痫发作状态是预先确定的，因此本工作将其指定为两个簇用于SO检测，三个簇用于SPO检测。</font>

<h2 id="Zr52m">总结</h2>
<font style="color:rgba(0, 0, 0, 0.85);">SODor框架的一个优势是它的两阶段学习过程，允许充分利用现有深度学习方法的高能力。实验结果证实，SODor框架具有很强的检测SO的能力，可能具有临床应用的潜力。</font>

